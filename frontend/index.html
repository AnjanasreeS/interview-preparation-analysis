<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Interview Prep Hub</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 30px 15px;
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      color: #333;
    }
    .running-text {
      font-size: 1.2rem;
      color: #007bff;
      margin-bottom: 20px;
      animation: scroll 10s linear infinite;
      white-space: nowrap;
      overflow: hidden;
      box-sizing: border-box;
    }
    @keyframes scroll {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      width: 200px;
      cursor: pointer;
      box-shadow: 0 6px 10px rgba(0,0,0,0.1);
      transition: transform 0.2s, box-shadow 0.3s, border-color 0.3s;
      border: 2px solid transparent;
    }
    .card:hover {
      transform: scale(1.05);
      border-color: #007bff;
      box-shadow: 0 10px 18px rgba(0,0,0,0.15);
    }
    .section {
      background: #fff;
      padding: 20px;
      margin: 20px auto;
      max-width: 800px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: left;
    }
    textarea {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      min-height: 100px;
      resize: vertical;
    }
    button {
      background: #007bff;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.3s;
      font-weight: 500;
    }
    button:hover {
      background: #0056b3;
    }
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
    #gestureVideo {
      width: 100%;
      max-width: 640px;
      height: auto;
      margin-top: 15px;
      border-radius: 10px;
      background: black;
    }
    .feedback-item {
      margin: 15px 0;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #007bff;
    }
    .positive {
      color: #28a745;
      font-weight: bold;
    }
    .negative {
      color: #dc3545;
      font-weight: bold;
    }
    .chart-container {
      margin: 25px 0;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }
    .chart-wrapper {
      width: 100%;
      max-width: 400px;
      height: 300px; /* Fixed height for charts */
      margin: 0 auto;
    }
    .score-display {
      font-size: 1.1rem;
      margin: 8px 0;
    }
    .improvement-tips {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
    }
    .improvement-tips h3 {
      margin-top: 0;
      color: #007bff;
    }
    .improvement-tips ul {
      padding-left: 20px;
    }
    .alert {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px;
      background: #28a745;
      color: white;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      z-index: 1000;
      animation: slideIn 0.5s, fadeOut 0.5s 2.5s forwards;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    .performance-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      margin: 20px 0;
      gap: 20px;
    }
    .performance-metrics {
      flex: 1;
      min-width: 300px;
      text-align: left;
    }
    .performance-chart {
      flex: 1;
      min-width: 300px;
    }
    .speech-recording {
      display: inline-block;
      margin-left: 10px;
    }
    .recording-dot {
      display: inline-block;
      width: 10px;
      height: 10px;
      background-color: red;
      border-radius: 50%;
      margin-right: 5px;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.3; }
      100% { opacity: 1; }
    }
    .progress-container {
      width: 100%;
      background-color: #f1f1f1;
      border-radius: 5px;
      margin: 10px 0;
    }
    .progress-bar {
      height: 20px;
      border-radius: 5px;
      text-align: center;
      line-height: 20px;
      color: white;
    }
    .question-bank {
      display: none;
      margin-top: 20px;
    }
    .question-item {
      padding: 10px;
      margin: 5px 0;
      background: #f8f9fa;
      border-radius: 5px;
      cursor: pointer;
    }
    .question-item:hover {
      background: #e9ecef;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <h1>Interview Prep Hub</h1>
  <div class="running-text">üöÄ You've got this! Practice makes perfect. Believe in yourself! üöÄ</div>

  <div style="display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; margin-bottom: 30px;">
    <div class="card" onclick="showTips('Technical')">üíª Technical</div>
    <div class="card" onclick="showTips('HR')">üßë‚Äçüíº HR</div>
    <div class="card" onclick="showTips('Behavioral')">üß† Behavioral</div>
    <div class="card" onclick="showFeedback()">üìä Performance Dashboard</div>
  </div>

  <div class="section" id="tipsSection">
    <h2>Select a category to view tips</h2>
  </div>

  <div class="section">
    <h2>üéØ Mock Practice (Text)</h2>
    <button onclick="toggleQuestionBank()" id="questionBankBtn">Show Question Bank</button>
    <div class="question-bank" id="questionBank">
      <div class="question-item" onclick="setQuestion('Describe a challenging project you worked on.')">Describe a challenging project you worked on.</div>
      <div class="question-item" onclick="setQuestion('Tell me about a time you had a conflict with a team member.')">Tell me about a time you had a conflict with a team member.</div>
      <div class="question-item" onclick="setQuestion('How do you handle tight deadlines?')">How do you handle tight deadlines?</div>
      <div class="question-item" onclick="setQuestion('What is your greatest strength?')">What is your greatest strength?</div>
      <div class="question-item" onclick="setQuestion('What is your biggest weakness?')">What is your biggest weakness?</div>
    </div>
    <p id="currentQuestion"><strong>Q:</strong> Describe a challenging project you worked on.</p>
    <textarea id="textAnswer" rows="5" placeholder="Type your answer here... (Try to use the STAR method: Situation, Task, Action, Result)"></textarea><br>
    <button onclick="evaluateTextResponse()">Submit Answer</button>
    <div id="textFeedback" class="feedback-item" style="display: none;"></div>
  </div>

  <div class="section">
    
    <a href="index2.html">gesture analysis</a>
    
  </div>

  <div class="section">
    
    <a href="index3.html">speech analysis</a>
  
  </div>

  <script>
    // Global variables
    let scores = { speech: 0, gestures: 0, text: 0 };
    let mediaStream = null;
    let speechRecognition = null;
    let gestureInterval = null;
    let isRecording = false;
    let recordingStartTime = 0;
    let progressInterval = null;

    // Show alert notification
    function showAlert(message, type = 'success') {
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert ${type}`;
      alertDiv.textContent = message;
      document.body.appendChild(alertDiv);
      
      setTimeout(() => {
        alertDiv.remove();
      }, 3000);
    }

    // Toggle question bank visibility
    function toggleQuestionBank() {
      const bank = document.getElementById('questionBank');
      const btn = document.getElementById('questionBankBtn');
      if (bank.style.display === 'block') {
        bank.style.display = 'none';
        btn.textContent = 'Show Question Bank';
      } else {
        bank.style.display = 'block';
        btn.textContent = 'Hide Question Bank';
      }
    }

    // Set question from bank
    function setQuestion(question) {
      document.getElementById('currentQuestion').innerHTML = `<strong>Q:</strong> ${question}`;
      toggleQuestionBank();
    }

    // Update progress bar
    function updateProgressBar(type, duration) {
      const progressBar = document.getElementById(`${type}Progress`);
      let width = 0;
      progressInterval = setInterval(() => {
        if (width >= 100) {
          clearInterval(progressInterval);
          return;
        }
        width += 100 / (duration / 100);
        progressBar.style.width = width + '%';
      }, 100);
    }

    // Reset progress bar
    function resetProgressBar(type) {
      clearInterval(progressInterval);
      document.getElementById(`${type}Progress`).style.width = '0%';
    }

    // Show tips for different categories
    function showTips(type) {
      const tips = {
        Technical: [
          "Master data structures and algorithms",
          "Review your past projects thoroughly",
          "Prepare for system design questions",
          "Practice coding on a whiteboard",
          "Know your tech stack inside out"
        ],
        HR: [
          "Research the company culture and values",
          "Prepare answers about your strengths/weaknesses",
          "Have thoughtful questions ready for the interviewer",
          "Be honest and authentic in your responses",
          "Show enthusiasm for the role and company"
        ],
        Behavioral: [
          "Use the STAR method (Situation, Task, Action, Result)",
          "Prepare 5-7 accomplishment stories from your experience",
          "Focus on teamwork, leadership, and problem-solving examples",
          "Be specific about your contributions and impact",
          "Show learning from challenges and failures"
        ]
      };
      
      let tipsHTML = `<h2>${type} Interview Tips</h2><ul>`;
      tips[type].forEach(tip => {
        tipsHTML += `<li>${tip}</li>`;
      });
      tipsHTML += "</ul>";
      
      document.getElementById('tipsSection').innerHTML = tipsHTML;
    }

    // Show overall feedback
    function showFeedback() {
      const overallScore = Math.round((scores.speech + scores.gestures + scores.text) / 3);
      
      let feedbackHTML = `
        <h2>Your Interview Performance Dashboard</h2>
        
        <div class="performance-container">
          <div class="performance-metrics">
            <h3>Performance Metrics</h3>
            <div class="score-display">
              <strong>Speech Clarity:</strong> ${scores.speech}% ${getScoreEmoji(scores.speech)}
            </div>
            <div class="score-display">
              <strong>Response Quality:</strong> ${scores.text}% ${getScoreEmoji(scores.text)}
            </div>
            <div class="score-display">
              <strong>Body Language:</strong> ${scores.gestures}% ${getScoreEmoji(scores.gestures)}
            </div>
          </div>
          
          <div class="performance-chart">
            <div class="chart-wrapper">
              <canvas id="pieChart"></canvas>
            </div>
          </div>
        </div>
        
        <div style="text-align: center; margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
          <h3>Overall Score: <span style="color: ${getScoreColor(overallScore)}; font-size: 1.3em;">${overallScore}% ${getScoreEmoji(overallScore)}</span></h3>
          <p style="font-size: 1.1em;">${getOverallFeedback(overallScore)}</p>
        </div>
        
        <div class="chart-wrapper">
          <canvas id="radarChart"></canvas>
        </div>
        
        <div class="improvement-tips">
          <h3>Personalized Improvement Tips</h3>
          <ul>
            ${getImprovementTips(scores)}
          </ul>
        </div>
      `;
      
      document.getElementById('tipsSection').innerHTML = feedbackHTML;
      renderFeedbackCharts();
    }

    // Helper functions
    function getScoreColor(score) {
      if (score >= 85) return '#28a745';
      if (score >= 70) return '#ffc107';
      return '#dc3545';
    }

    function getScoreEmoji(score) {
      if (score >= 85) return 'üòä';
      if (score >= 70) return 'üôÇ';
      return 'üòü';
    }

    function getOverallFeedback(score) {
      if (score >= 85) return "<span class='positive'>Excellent! You're interview-ready!</span>";
      if (score >= 70) return "Good job! With some practice, you'll be ready soon.";
      return "<span class='negative'>Needs more practice. Review the tips and try again.</span>";
    }

    function getImprovementTips(scores) {
      let tips = [];
      if (scores.speech < 70) tips.push("<li>Practice speaking slowly and clearly to improve speech (current: "+scores.speech+"%)</li>");
      if (scores.gestures < 70) tips.push("<li>Work on posture and eye contact for better body language (current: "+scores.gestures+"%)</li>");
      if (scores.text < 70) tips.push("<li>Use the STAR method to structure your answers (current: "+scores.text+"%)</li>");
      if (tips.length === 0) return "<li>Keep up the good work! Focus on refining your delivery.</li>";
      return tips.join('');
    }

    // Text evaluation
    function evaluateTextResponse() {
      const answer = document.getElementById("textAnswer").value.trim();
      if (!answer) {
        alert("Please enter your answer first!");
        return;
      }

      showAlert("Answer submitted successfully!");
      
      // Calculate score (simplified)
      const wordCount = answer.split(/\s+/).length;
      const hasStar = /situation|task|action|result/i.test(answer);
      let score = Math.min(wordCount * 0.8, 40) + (hasStar ? 30 : 0) + 30;
      score = Math.min(score, 100);
      scores.text = Math.round(score);
      
      document.getElementById("textFeedback").innerHTML = `
        <strong>Score: ${scores.text}% ${getScoreEmoji(scores.text)}</strong><br>
        ${wordCount < 40 ? "<span class='negative'>Too short. Aim for 50+ words.</span>" : "<span class='positive'>Good length.</span>"}
        ${!hasStar ? "<span class='negative'>Try using the STAR method.</span>" : "<span class='positive'>Good use of STAR method.</span>"}
      `;
      document.getElementById("textFeedback").style.display = "block";
      
      if (document.getElementById('tipsSection').innerHTML.includes('Performance Dashboard')) {
        showFeedback();
      }
    }

    // Speech evaluation
    /* function startSpeechRecording() {
      if (!('webkitSpeechRecognition' in window)) {
        alert("Speech recognition not supported in your browser. Try Chrome or Edge.");
        return;
      }
      
      showAlert("Recording started. Speak clearly now...");
      document.getElementById("stopSpeechBtn").disabled = false;
      document.getElementById("startSpeechBtn").disabled = true;
      document.getElementById("recordingStatus").style.display = "inline";
      isRecording = true;
      recordingStartTime = Date.now();
      updateProgressBar('speech', 10000); // 10 seconds progress bar
      
      speechRecognition = new webkitSpeechRecognition();
      speechRecognition.continuous = false;
      speechRecognition.interimResults = false;
      speechRecognition.lang = 'en-US';
      
      speechRecognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        analyzeSpeech(transcript);
      };
      
      speechRecognition.onerror = (event) => {
        console.error("Speech recognition error", event.error);
        stopSpeechRecording();
      };
      
      speechRecognition.start();
    }

    function stopSpeechRecording() {
      if (speechRecognition) speechRecognition.stop();
      document.getElementById("stopSpeechBtn").disabled = true;
      document.getElementById("startSpeechBtn").disabled = false;
      document.getElementById("recordingStatus").style.display = "none";
      isRecording = false;
      resetProgressBar('speech');
    }

    function analyzeSpeech(transcript) {
      const wordCount = transcript.split(/\s+/).length;
      let score = Math.min(wordCount * 2, 100);
      scores.speech = Math.round(score);
      
      document.getElementById("speechFeedback").innerHTML = `
        <strong>Score: ${scores.speech}% ${getScoreEmoji(scores.speech)}</strong><br>
        <strong>You said:</strong> "${truncate(transcript, 100)}"<br><br>
        ${wordCount < 20 ? "<span class='negative'>Too short. Aim for 30+ words.</span>" : "<span class='positive'>Good response length.</span>"}
      `;
      document.getElementById("speechFeedback").style.display = "block";
      stopSpeechRecording();
      
      if (document.getElementById('tipsSection').innerHTML.includes('Performance Dashboard')) {
        showFeedback();
      }
    }

    // Gesture analysis
    function startGestureAnalysis() {
      const video = document.getElementById("gestureVideo");
      document.getElementById("stopGestureBtn").disabled = false;
      document.getElementById("startGestureBtn").disabled = true;
      video.style.display = "block";
      updateProgressBar('gesture', 5000); // 5 seconds progress bar
      
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
          mediaStream = stream;
          video.srcObject = stream;
          gestureInterval = setTimeout(() => {
            analyzeGestures();
          }, 5000);
        })
        .catch(err => {
          alert("Could not access camera: " + err.message);
          document.getElementById("startGestureBtn").disabled = false;
        });
    }

    function stopGestureAnalysis() {
      if (mediaStream) {
        mediaStream.getTracks().forEach(track => track.stop());
        document.getElementById("gestureVideo").style.display = "none";
        document.getElementById("stopGestureBtn").disabled = true;
        document.getElementById("startGestureBtn").disabled = false;
        clearTimeout(gestureInterval);
        resetProgressBar('gesture');
      }
    }

    function analyzeGestures() {
      const score = Math.floor(Math.random() * 30) + 70;
      scores.gestures = score;
      
      document.getElementById("gestureFeedback").innerHTML = `
        <strong>Score: ${scores.gestures}% ${getScoreEmoji(scores.gestures)}</strong><br>
        ${score >= 85 ? "<span class='positive'>Excellent posture and eye contact!</span>" : 
        score >= 70 ? "Good presence. Try to maintain more consistent eye contact." : 
        "<span class='negative'>Watch your posture and eye contact.</span>"}
      `;
      document.getElementById("gestureFeedback").style.display = "block";
      stopGestureAnalysis();
      
      if (document.getElementById('tipsSection').innerHTML.includes('Performance Dashboard')) {
        showFeedback();
      }
    }
 */
    // Chart rendering
    function renderFeedbackCharts() {
      // Pie Chart
      const pieCtx = document.getElementById('pieChart').getContext('2d');
      new Chart(pieCtx, {
        type: 'pie',
        data: {
          labels: ['Speech', 'Content', 'Body Language'],
          datasets: [{
            data: [scores.speech, scores.text, scores.gestures],
            backgroundColor: ['#007bff', '#28a745', '#ffc107'],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { position: 'right' }
          }
        }
      });
      
      // Radar Chart
      const radarCtx = document.getElementById('radarChart').getContext('2d');
      new Chart(radarCtx, {
        type: 'radar',
        data: {
          labels: ['Clarity', 'Content', 'Confidence', 'Structure', 'Body Language'],
          datasets: [{
            label: 'Your Performance',
            data: [scores.speech, scores.text, (scores.speech+scores.gestures)/2, scores.text*0.8, scores.gestures],
            backgroundColor: 'rgba(0, 123, 255, 0.2)',
            borderColor: '#007bff',
            pointBackgroundColor: '#007bff'
          }]
        },
        options: {
          responsive: true,
          scales: { r: { suggestedMin: 0, suggestedMax: 100 } }
        }
      });
    }

    // Initialize with behavioral tips
    showTips('Behavioral');
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
  <video id="video" width="320" height="240" autoplay muted style="display:none;"></video>


</body>
</html>